% Tipo:
% 1 - PQ
% 2 - PV
% 3 - folga

%         Bus      Type V    Degree Pg     Qg     Pd     Qd   Gs   Bs  Qmin    Qmax   
bus    =  [ 1     3    1.06    0    260.2 -16.1    0     0     0    0     0      10;
            2     2    1.045   0      40   50.0  21.7   12.7   0    0    -40     50;
            3     1    1.0     0       0     0    2.4    1.2   0    0     0       0;
            4     1    1.06    0       0     0    7.6    1.6   0    0     0       0;
            5     2    1.01    0       0   37.0  94.2   19.0   0    0    -40     40;
            6     1    1.0     0       0     0    0.0    0.0   0    0     0       0;
            7     1    1.0     0       0     0   22.8   10.9   0    0     0       0;
            8     2    1.01    0       0   37.3  30.0   30.0   0    0    -10     40;
            9     1    1.0     0       0     0    0.0    0.0   0    0     0       0;
            10    1    1.0     0       0     0    5.8    2.0   0   19     0       0;
            11    2    1.082   0       0   16.2   0.0    0.0   0    0    -6      24;
            12    1    1.0     0       0     0   11.2    7.5   0    0     0       0;
            13    2    1.071   0       0   10.6   0.0    0.0   0    0    -6      24;
            14    1    1.0     0       0     0    6.2    1.6   0    0     0       0;
            15    1    1.0     0       0     0    8.2    2.5   0    0     0       0;
            16    1    1.0     0       0     0    3.5    1.8   0    0     0       0;
            17    1    1.0     0       0     0    9.0    5.8   0    0     0       0;
            18    1    1.0     0       0     0    3.2    0.9   0    0     0       0;
            19    1    1.0     0       0     0    9.5    3.4   0    0     0       0;
            20    1    1.0     0       0     0    2.2    0.7   0    0     0       0;
            21    1    1.0     0       0     0   17.5   11.2   0    0     0       0;
            22    1    1.0     0       0     0    0.0    0.0   0    0     0       0;
            23    1    1.0     0       0     0    3.2    1.6   0    0     0       0;
            24    1    1.0     0       0     0   8.7    6.7    0   4.3    0       0;
            25    1    1.0     0       0     0    0.0    0.0   0    0     0       0;
            26    1    1.0     0       0     0    3.5    2.3   0    0     0       0;
            27    1    1.0     0       0     0    0.0    0.0   0    0     0       0;
            28    1    1.0     0       0     0    0.0    0.0   0    0     0       0;
            29    1    1.0     0       0     0    2.4    0.9   0    0     0       0;
            30    1    1.0     0       0     0   10.6    1.9   0    0     0       0 ];
        
%        from       to   R       X     b      a    shift
line  =  [   1      2       0.0192    0.0575     0.0528         1     0;
             1      3       0.0452    0.1652     0.0408         1     0;
             2      4       0.0570    0.1737     0.0368         1     0;
             3      4       0.0132    0.0379     0.0084         1     0;
             2      5       0.0472    0.1983     0.0418         1     0;
             2      6       0.0581    0.1763     0.0374         1     0;
             4      6       0.0119    0.0414     0.0090         1     0;
             5      7       0.0460    0.1160     0.0204         1     0;
             6      7       0.0267    0.0820     0.0170         1     0;
             6      8       0.0120    0.0420     0.0090         1     0;
             6      9       0.0       0.2080     0.0        0.978     0;
             6     10       0.0       0.5560     0.0        0.969     0;
             9     11       0.0       0.2080     0.0            1     0;
             9     10       0.0       0.1100     0.0            1     0;
             4     12       0.0       0.2560     0.0        0.932     0;
            12     13       0.0       0.1400     0.0            1     0;
            12     14       0.1231    0.2559     0.0            1     0;
            12     15       0.0662    0.1304     0.0            1     0;
            12     16       0.0945    0.1987     0.0            1     0;
            14     15       0.2210    0.1997     0.0            1     0;
            16     17       0.0524    0.1923     0.0            1     0;
            15     18       0.1073    0.2185     0.0            1     0;
            18     19       0.0639    0.1292     0.0            1     0;
            19     20       0.0340    0.0680     0.0            1     0;
            10     20       0.0936    0.2090     0.0            1     0;
            10     17       0.0324    0.0845     0.0            1     0;
            10     21       0.0348    0.0749     0.0            1     0;
            10     22       0.0727    0.1499     0.0            1     0;
            21     23       0.0116    0.0236     0.0            1     0;
            15     23       0.1000    0.2020     0.0            1     0;
            22     24       0.1150    0.1790     0.0            1     0;
            23     24       0.1320    0.2700     0.0            1     0;
            24     25       0.1885    0.3292     0.0            1     0;
            25     26       0.2544    0.3800     0.0            1     0;
            25     27       0.1093    0.2087     0.0            1     0;
            28     27       0.0       0.3960     0.0        0.968     0;
            27     29       0.2198    0.4153     0.0            1     0;
            27     30       0.3202    0.6027     0.0            1     0;
            29     30       0.2399    0.4533     0.0            1     0;
             8     28       0.0636    0.2000     0.0428         1     0;
             6     28       0.0169    0.0599     0.013          1     0];